---
tags: [å‰ç«¯å¼€å‘, dumi, Umi, è‡ªåŠ¨è·¯ç”±, Markdown]
category: å‰ç«¯æ¶æ„
date: 2025-01-07
title: æˆ‘ä¸çŸ¥é“çš„ dumiï¼šè‡ªåŠ¨è·¯ç”±ç”Ÿæˆçš„åŸç†è§£æ
desc: æ­ç§˜ dumi å¦‚ä½•åŸºäºç›®å½•ç»“æ„å’Œ Markdown æ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£è·¯ç”±çš„åŸç†ä¸å®è·µã€‚
slug: dumi-03
---

dumi æ˜¯åŸºäº Umi çš„ç»„ä»¶æ–‡æ¡£å·¥å…·ï¼Œå…¶è‡ªåŠ¨è·¯ç”±ç”Ÿæˆæœºåˆ¶ä»¤äººç§°å¥‡â€”â€”åªéœ€æ”¾ç½® Markdown æ–‡ä»¶ï¼Œè·¯ç”±å³åˆ»ç”Ÿæˆï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®ã€‚è¿™ä¸€â€œé­”æ³•â€å¦‚ä½•å®ç°ï¼Ÿæœ¬æ–‡å°†ä» dumi çš„çº¦å®šå¼è·¯ç”±è®¾è®¡å…¥æ‰‹ï¼Œæ·±å…¥æ­å¼€æ–‡ä»¶åˆ°è·¯ç”±çš„è½¬æ¢æµç¨‹ï¼Œåˆ†æå…ƒæ•°æ®è§£æä¸å¤šçº§åµŒå¥—å¤„ç†ï¼Œæ¢ç´¢è·¯ç”±ä¸ç»„ä»¶é¢„è§ˆçš„è”åŠ¨åŠæ‰©å±•å®è·µã€‚è¿™æ˜¯ä¸€åœºä»åŸç†åˆ°åº”ç”¨çš„å®Œæ•´æ—…ç¨‹ï¼Œå¸¦ä½ ç†è§£ dumi çš„è·¯ç”±ç”Ÿæˆå¥¥ç§˜ã€‚ğŸš€

---

## 1. dumi çº¦å®šå¼è·¯ç”±ç³»ç»Ÿçš„è®¾è®¡åŸåˆ™

dumi çš„è·¯ç”±ç³»ç»Ÿéµå¾ªâ€œçº¦å®šå¤§äºé…ç½®â€çš„è®¾è®¡å“²å­¦ï¼Œæ—¨åœ¨ç®€åŒ–æ–‡æ¡£å¼€å‘æµç¨‹ã€‚

- **æ ¸å¿ƒåŸåˆ™**ï¼š
  - **æ–‡ä»¶å³è·¯ç”±**ï¼šç›®å½•ç»“æ„ç›´æ¥æ˜ å°„ä¸ºè·¯ç”±è·¯å¾„ã€‚
  - **ç®€å•ç›´è§‚**ï¼šæ–‡ä»¶å‘½åä¸ä½ç½®å†³å®šè·¯ç”±ï¼Œæ— éœ€å¤æ‚é…ç½®ã€‚
  - **çµæ´»æ‰©å±•**ï¼šæ”¯æŒå¤šè¯­è¨€ç­‰é«˜çº§éœ€æ±‚ã€‚
  - **ç»„ä»¶å…¼å®¹**ï¼šæ— ç¼é›†æˆæ–‡æ¡£ä¸ç»„ä»¶é¢„è§ˆã€‚
- **å®ç°åŸºç¡€**ï¼š
  - dumi é€šè¿‡ `@umijs/preset-dumi` æ‰©å±• Umi çš„è·¯ç”±åŠŸèƒ½ï¼Œæ‰«ææŒ‡å®šç›®å½•ï¼ˆå¦‚ `docs/`ï¼‰ã€‚
  - **ç»†èŠ‚**ï¼šé…ç½® `resolve.includes` æŒ‡å®šæ‰«æèŒƒå›´ã€‚
  - **ç¤ºä¾‹**ï¼š
    ```javascript
    // .umirc.ts
    import { defineConfig } from 'dumi';
    export default defineConfig({
      resolve: { includes: ['docs'] },
    });
    ```

**è®¾è®¡é€»è¾‘**ï¼šçº¦å®šå¼è·¯ç”±ä»¥ç›´è§‚æ€§ä¸ºæ ¸å¿ƒï¼Œå¥ å®šè‡ªåŠ¨ç”Ÿæˆçš„åŸºç¡€ã€‚

---

## 2. ä»æ–‡ä»¶åˆ°è·¯ç”±çš„è½¬æ¢æµç¨‹è¯¦è§£

dumi å°† Markdown æ–‡ä»¶è½¬ä¸ºè·¯ç”±çš„æµç¨‹åŒ…å«å¤šä¸ªé˜¶æ®µã€‚

- **è½¬æ¢æµç¨‹**ï¼š
  1. **æ–‡ä»¶æ‰«æ**ï¼šæ‰«æ `resolve.includes` æŒ‡å®šçš„ç›®å½•ï¼Œè¯†åˆ« `.md` æ–‡ä»¶ã€‚
  2. **è·¯å¾„åˆ†æ**ï¼šæå–ç›¸å¯¹è·¯å¾„ï¼Œè§„èŒƒåŒ–è·¯ç”±ï¼ˆå¦‚ `index.md` è½¬ä¸º `/`ï¼‰ã€‚
  3. **å…ƒæ•°æ®è§£æ**ï¼šè¯»å– frontmatterï¼Œæå–è·¯ç”±ä¿¡æ¯ã€‚
  4. **è·¯ç”±ç”Ÿæˆ**ï¼šåˆ›å»ºè·¯ç”±å¯¹è±¡ï¼Œç»‘å®šç»„ä»¶ã€‚
  5. **è¾“å‡º**ï¼šç”Ÿæˆé™æ€ HTML ä¸å¯¼èˆªã€‚
- **å®ç°ç»†èŠ‚**ï¼š
  - **æ‰«æ**ï¼šä½¿ç”¨ Umi çš„ `glob` æ¨¡å—æ‰«ææ–‡ä»¶ã€‚
  - **ä¼ªä»£ç **ï¼š
    ```javascript
    function scanFiles(dir) {
      const files = glob.sync(`${dir}/**/*.md`, { ignore: ['**/node_modules/**'] });
      return files.map(file => ({
        path: normalizePath(file),
        content: readFile(file),
      }));
    }
    ```
  - **ç¤ºä¾‹**ï¼š
    ```
    docs/
    â”œâ”€â”€ index.md       -> /
    â”œâ”€â”€ guide.md       -> /guide
    â””â”€â”€ components/
        â””â”€â”€ button.md  -> /components/button
    ```

**è½¬æ¢é€»è¾‘**ï¼šæ–‡ä»¶è·¯å¾„ä¸å…ƒæ•°æ®ç»“åˆï¼Œè‡ªåŠ¨ç”Ÿæˆè·¯ç”±è¡¨ã€‚

---

## 3. å…ƒæ•°æ®è§£æä¸è·¯ç”±é…ç½®ç”Ÿæˆæœºåˆ¶

dumi é€šè¿‡è§£æ Markdown æ–‡ä»¶çš„ frontmatter ç”Ÿæˆè·¯ç”±å…ƒæ•°æ®ã€‚

- **å…ƒæ•°æ®è§£æ**ï¼š
  - **åŸç†**ï¼šä½¿ç”¨ `gray-matter` è§£æ YAML å¤´éƒ¨ã€‚
  - **ç»†èŠ‚**ï¼š`@umijs/preset-dumi` çš„ `remark-frontmatter` æ’ä»¶æå–å­—æ®µã€‚
  - **ç¤ºä¾‹**ï¼š
    ```markdown
    <!-- docs/guide.md -->
    ---
    title: Guide Page
    order: 1
    nav: Guide
    ---
    # Welcome
    ```
- **è·¯ç”±é…ç½®ç”Ÿæˆ**ï¼š
  - **æœºåˆ¶**ï¼šå°†å…ƒæ•°æ®æ³¨å…¥ Umi çš„ `IRoute` å¯¹è±¡ã€‚
  - **ç»†èŠ‚**ï¼šé€šè¿‡ `api.modifyRoutes` æ‰©å±•è·¯ç”±ã€‚
  - **ç¤ºä¾‹**ï¼š
    ```javascript
    // è·¯ç”±å¯¹è±¡
    {
      path: '/guide',
      component: 'docs/guide.md',
      exact: true,
      meta: { title: 'Guide Page', order: 1, nav: 'Guide' }
    }
    ```

**ç”Ÿæˆé€»è¾‘**ï¼šå…ƒæ•°æ®é©±åŠ¨è·¯ç”±é…ç½®ï¼Œæå‡å¯¼èˆªçµæ´»æ€§ã€‚

---

## 4. å¤šçº§åµŒå¥—çš„å¤„ç†ç­–ç•¥

dumi æ”¯æŒå¤šçº§åµŒå¥—è·¯ç”±ï¼Œé€‚åº”å¤æ‚æ–‡æ¡£ç»“æ„ã€‚

- **å¤šçº§åµŒå¥—**ï¼š
  - **åŸç†**ï¼šå­ç›®å½•è‡ªåŠ¨è½¬ä¸ºåµŒå¥—è·¯ç”±ï¼Œ`index.md` ä½œä¸ºé»˜è®¤å…¥å£ã€‚
  - **ç»†èŠ‚**ï¼šUmi çš„ `IRoute` æ¥å£æ”¯æŒåµŒå¥—å±‚çº§ï¼Œdumi æ‰©å±•å¯¼èˆªæ ‘ã€‚
  - **ç¤ºä¾‹**ï¼š
    ```
    docs/
    â””â”€â”€ guide/
        â”œâ”€â”€ index.md    -> /guide
        â””â”€â”€ advanced.md -> /guide/advanced
    ```
- **ä¼˜å…ˆçº§**ï¼š
  - ç²¾ç¡®è·¯å¾„ä¼˜å…ˆäºè¾ƒé•¿çš„åµŒå¥—è·¯å¾„ã€‚
  - `order` å€¼å°çš„è·¯ç”±ä¼˜å…ˆå±•ç¤ºã€‚

**å¤„ç†ç­–ç•¥**ï¼šåµŒå¥—è·¯ç”±æ”¯æŒå¤æ‚å¯¼èˆªéœ€æ±‚ã€‚

---

## 5. è·¯ç”±ä¸ç»„ä»¶é¢„è§ˆçš„è”åŠ¨å®ç°

dumi å°†è·¯ç”±ä¸ç»„ä»¶é¢„è§ˆè”åŠ¨ï¼Œæå‡äº¤äº’ä½“éªŒã€‚

- **è”åŠ¨æœºåˆ¶**ï¼š
  - **åŸç†**ï¼šMarkdown ä¸­çš„ JSX ä»£ç å—é€šè¿‡ `@umijs/preset-dumi` è½¬ä¸ºå¯äº¤äº’ç»„ä»¶ã€‚
  - **å®ç°**ï¼š`sucrase` ç¼–è¯‘ JSXï¼Œå®¢æˆ·ç«¯æ¸²æŸ“ã€‚
  - **ä¼ªä»£ç **ï¼š
    ```javascript
    function renderPreview(code, meta) {
      if (meta.type === 'preview') {
        const compiled = sucrase.transform(code, { transforms: ['jsx'] });
        return <div>{eval(compiled.code)()}</div>;
      }
      return <pre>{code}</pre>;
    }
    ```
  - **ç¤ºä¾‹**ï¼š
    ```markdown
    <!-- docs/button.md -->
    # Button
    ```jsx
    export default () => <button>Click me</button>;
    ```
    ```
    ç”Ÿæˆè·¯ç”± `/button`ï¼ŒåŒ…å«äº¤äº’æŒ‰é’®ã€‚
- **ç»†èŠ‚**ï¼šè·¯ç”±é¡µé¢é€šè¿‡ dumi çš„æ¸²æŸ“å™¨åŠ è½½é¢„è§ˆç»„ä»¶ã€‚

**è”åŠ¨é€»è¾‘**ï¼šè·¯ç”±é©±åŠ¨é¡µé¢ï¼Œç»„ä»¶é¢„è§ˆå¢å¼ºäº¤äº’æ€§ã€‚

---

## 6. æ‰©å±•è·¯ç”±æ”¯æŒå¤šè¯­è¨€ä¸åŠ¨æ€å†…å®¹çš„å®è·µ

dumi çš„è·¯ç”±ç³»ç»Ÿæ”¯æŒæ‰©å±•ï¼Œé€‚åº”å¤šè¯­è¨€ä¸åŠ¨æ€å†…å®¹ã€‚

- **å¤šè¯­è¨€æ”¯æŒ**ï¼š
  - **åŸç†**ï¼šé€šè¿‡è¯­è¨€åç¼€ï¼ˆå¦‚ `.en.md`ï¼‰åŒºåˆ†ç‰ˆæœ¬ã€‚
  - **å®è·µ**ï¼š
    ```javascript
    // plugin-i18n.js
    export default (api) => {
      api.modifyRoutes((routes) => {
        const enRoutes = routes.map(route => ({
          ...route,
          path: `/en${route.path}`,
          meta: { ...route.meta, lang: 'en' },
        }));
        return [...routes, ...enRoutes];
      });
    };
    ```
  - **é…ç½®**ï¼š
    ```javascript
    // .umirc.ts
    export default { plugins: [require.resolve('./plugin-i18n.js')] };
    ```
  - **æ–‡ä»¶ç»“æ„**ï¼š
    ```
    docs/
    â”œâ”€â”€ guide.md      -> /guide
    â””â”€â”€ guide.en.md   -> /en/guide
    ```
- **åŠ¨æ€å†…å®¹**ï¼š
  - **åŸç†**ï¼šé€šè¿‡ `api.onGenerateFiles` ç”Ÿæˆè·¯ç”±ã€‚
  - **ç¤ºä¾‹**ï¼š
    ```javascript
    export default (api) => {
      api.onGenerateFiles(() => {
        api.writeTmpFile({
          path: 'dumi/dynamic.tsx',
          content: 'export default () => <div>Dynamic</div>;',
        });
      });
      api.modifyRoutes((routes) => [
        ...routes,
        { path: '/dynamic', component: 'dumi/dynamic.tsx' },
      ]);
    };
    ```

**æ‰©å±•é€»è¾‘**ï¼šæ’ä»¶åŒ–æ‰©å±•æ”¯æŒå¤šè¯­è¨€ä¸åŠ¨æ€å†…å®¹ã€‚

---

## æ€»ç»“ï¼šä»çº¦å®šåˆ°æ‰©å±•çš„æ—…ç¨‹

dumi é€šè¿‡çº¦å®šå¼è·¯ç”±ï¼Œå°† Markdown æ–‡ä»¶è½¬ä¸ºé«˜æ•ˆæ–‡æ¡£å¯¼èˆªã€‚è®¾è®¡å¥ åŸºï¼Œæµç¨‹ä¼˜åŒ–ï¼Œå…ƒæ•°æ®é©±åŠ¨ï¼ŒåµŒå¥—ä¸é¢„è§ˆè”åŠ¨ï¼Œæœ€ç»ˆå½¢æˆæ‰©å±•é—­ç¯ã€‚æœªæ¥ï¼Œdumi å¯é€šè¿‡ AI ä¼˜åŒ–è·¯ç”±ç”Ÿæˆï¼Œæˆ–æ”¯æŒæ›´å¤æ‚åœºæ™¯ã€‚ç†è§£è¿™ä¸€è¿‡ç¨‹ï¼Œä½ ä¼šæ›´ä»å®¹åœ°æ„å»ºæ–‡æ¡£è·¯ç”±ã€‚ä¸‹æ¬¡ç¼–å†™æ–‡æ¡£æ—¶ï¼Œæƒ³æƒ³è¿™èƒŒåçš„å¹•åé€»è¾‘å§ï¼ğŸ’¡
